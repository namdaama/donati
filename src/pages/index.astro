---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import OverViewHero from '../components/OverViewHero.astro';
import Footer from '../components/Footer.astro';
import AnnouncementCard from '../components/AnnouncementCard.astro';
import { fetchInstagramPosts } from '../lib/instagram-rss';
import { filterAnnouncementPosts } from '../lib/announcement-parser';
import { instagramConfig } from '../config/instagram';

// Instagram RSSã‹ã‚‰ãŠçŸ¥ã‚‰ã›ã‚’å–å¾—
import type { AnnouncementPost } from '../types/instagram';

let announcements: AnnouncementPost[] = [];
if (instagramConfig.rssUrl) {
  const posts = await fetchInstagramPosts(instagramConfig.rssUrl);

  if (instagramConfig.enableHashtagFilter) {
    announcements = filterAnnouncementPosts(posts, instagramConfig.announcementHashtag);
  } else {
    // ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç„¡åŠ¹ã®å ´åˆã€ã™ã¹ã¦ã®æŠ•ç¨¿ã‚’è¡¨ç¤º
    announcements = posts.map(post => ({
      ...post,
      category: 'news' as const,
      eventDate: undefined,
      location: undefined
    }));
  }

  // æœ€æ–°4æŠ•ç¨¿ã®ã¿è¡¨ç¤º
  announcements = announcements.slice(0, instagramConfig.maxDisplayPosts);
}

// ã‚¹ã‚¿ãƒƒãƒ•æƒ…å ±
const staffMembers = [
  {
    name: 'ã‚¹ã‚¿ãƒƒãƒ•A',
    role: 'ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚¿ãƒ¼',
    description: 'å®Ÿé¨“ã‚·ãƒ§ãƒ¼ã¨æ˜Ÿç©ºã®ãŠè©±ã§ã€ã¿ã‚“ãªã¨ä¸€ç·’ã«æ¥½ã—ã¿ã¾ã™ï¼'
  },
  {
    name: 'ã‚¹ã‚¿ãƒƒãƒ•B', 
    role: 'å®‡å®™æ•™è‚²ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ',
    description: 'å®‡å®™ã®ç´ æ•µãªã¨ã“ã‚ã‚’ã€ã¿ã‚“ãªã«æ¥½ã—ããŠè©±ã—ã—ã¾ã™ï¼'
  }
];

// ãŠä»•äº‹æƒ…å ±
const services = [
  'å®Ÿé¨“ã‚·ãƒ§ãƒ¼',
  'ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—',
  'æ˜Ÿç©ºè¦³å¯Ÿå¡¾',
  'æ˜Ÿç©ºã®å…ˆç”Ÿ',
  'å‡ºå¼µæˆæ¥­',
  'ç§‘å­¦ã‚¤ãƒ™ãƒ³ãƒˆä¼ç”»'
];
---

<Layout title="OverView - DONATI">
  <Header />
  
  <main class="flex-grow">
    <!-- Hero Section -->
    <OverViewHero 
      title="DONATIã¨ã¯ï¼Ÿ"
      subtitle="ç§‘å­¦ã®æ¥½ã—ã•ã¨å®‡å®™ã®ç¥ç§˜ã‚’ã€ã¿ã‚“ãªã§ä¸€ç·’ã«ä½“é¨“ã—ã¾ã›ã‚“ã‹ï¼Ÿå­ã©ã‚‚ã‹ã‚‰å¤§äººã¾ã§ã€ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹ç™ºè¦‹ãŒã“ã“ã«ã‚ã‚Šã¾ã™ã€‚"
      ctaText="è©³ã—ãã¯ã‚³ãƒãƒ©"
      ctaLink="/about"
    />
    
    <!-- ãŠçŸ¥ã‚‰ã›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section class="py-16 md:py-24 bg-transparent">
      <div class="container mx-auto px-4">
        <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ« -->
        <div class="text-center mb-12">
          <h2 class="text-4xl md:text-5xl font-bold text-overview-dark-blue mb-4">
            ãŠçŸ¥ã‚‰ã›
          </h2>
          <div class="w-24 h-1 bg-overview-yellow mx-auto"></div>
        </div>
        
        <!-- 4åˆ—ã‚°ãƒªãƒƒãƒ‰ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {announcements.length > 0 ? (
            announcements.map((announcement) => (
              <AnnouncementCard announcement={announcement} />
            ))
          ) : (
            <div class="col-span-4 text-center py-12">
              <p class="text-overview-dark-blue text-lg">
                ãŠçŸ¥ã‚‰ã›ã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™...
              </p>
              <p class="text-gray-600 text-sm mt-2">
                Instagramã®æŠ•ç¨¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
              </p>
            </div>
          )}
        </div>
      </div>
    </section>
    
    <!-- ä¸‹éƒ¨3åˆ—ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section class="py-16 md:py-24 bg-transparent">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          
          <!-- 1. ã‚¹ã‚¿ãƒƒãƒ•ã«ã¤ã„ã¦ -->
          <div class="bg-white/15 backdrop-blur-sm rounded-2xl shadow-lg p-8 border-t-4 border-overview-sky">
            <div class="text-center mb-6">
              <div class="w-16 h-16 bg-overview-sky rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="text-2xl">ğŸ‘¥</span>
              </div>
              <h3 class="text-2xl font-bold text-overview-dark-blue">
                ã‚¹ã‚¿ãƒƒãƒ•ã«ã¤ã„ã¦
              </h3>
            </div>
            
            <div class="space-y-4 mb-6">
              {staffMembers.map((staff) => (
                <div class="bg-overview-sky/10 p-4 rounded-lg">
                  <h4 class="font-bold text-overview-dark-blue mb-1">
                    {staff.name}
                  </h4>
                  <p class="text-sm text-overview-sky font-medium mb-2">
                    {staff.role}
                  </p>
                  <p class="text-sm text-gray-600">
                    {staff.description}
                  </p>
                </div>
              ))}
            </div>
            
            <div class="text-center">
              <a href="/staff" class="inline-block bg-overview-sky hover:bg-overview-sky/90 text-white font-bold py-3 px-6 rounded-full transition-colors duration-300">
                è©³ã—ãã¯ã‚³ãƒãƒ©
              </a>
            </div>
          </div>
          
          <!-- 2. ãŠä»•äº‹ã®ã“ã¨ -->
          <div class="bg-white/15 backdrop-blur-sm rounded-2xl shadow-lg p-8 border-t-4 border-overview-yellow">
            <div class="text-center mb-6">
              <div class="w-16 h-16 bg-overview-yellow rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="text-2xl">âš—ï¸</span>
              </div>
              <h3 class="text-2xl font-bold text-overview-dark-blue">
                ãŠä»•äº‹ã®ã“ã¨
              </h3>
            </div>
            
            <ul class="space-y-3 mb-6">
              {services.map((service) => (
                <li class="flex items-center">
                  <span class="w-2 h-2 bg-overview-yellow rounded-full mr-3"></span>
                  <span class="text-overview-dark-blue font-medium">{service}</span>
                </li>
              ))}
            </ul>
            
            <div class="text-center">
              <a href="/services" class="inline-block bg-overview-yellow hover:bg-overview-yellow/90 text-overview-dark-blue font-bold py-3 px-6 rounded-full transition-colors duration-300">
                è©³ã—ãã¯ã‚³ãƒãƒ©
              </a>
            </div>
          </div>
          
          <!-- 3. ãŠå•ã„åˆã‚ã› -->
          <div class="bg-white/15 backdrop-blur-sm rounded-2xl shadow-lg p-8 border-t-4 border-overview-dark-blue">
            <div class="text-center mb-6">
              <div class="w-16 h-16 bg-overview-dark-blue rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="text-2xl text-white">âœ‰ï¸</span>
              </div>
              <h3 class="text-2xl font-bold text-overview-dark-blue">
                ãŠå•ã„åˆã‚ã›
              </h3>
            </div>
            
            <div class="space-y-4 mb-6">
              <div class="text-center">
                <p class="text-sm text-gray-600 mb-2">é›»è©±ç•ªå·</p>
                <p class="text-xl font-bold text-overview-dark-blue">
                  000-0000-0000
                </p>
              </div>
              
              <div class="text-center">
                <p class="text-sm text-gray-600 mb-2">å–¶æ¥­æ™‚é–“</p>
                <p class="text-sm text-overview-dark-blue">
                  å¹³æ—¥ãƒ»åœŸæ—¥ 9:00ï½18:00<br>
                  å¹´ä¸­ç„¡ä¼‘ï¼ˆå¹´æœ«å¹´å§‹é™¤ãï¼‰
                </p>
              </div>
              
              <div class="bg-overview-sky/10 p-4 rounded-lg text-center">
                <p class="text-sm text-overview-dark-blue font-medium">
                  ã€Œã©ã‚“ãªçµ„ã¿åˆã‚ã›ã§ã‚‚ã€æ¥½ã—ãå¯¾å¿œã•ã›ã¦ã„ãŸã ãã¾ã™ï¼ã€
                </p>
              </div>
            </div>
            
            <div class="text-center">
              <a href="/contact" class="inline-block bg-overview-dark-blue hover:bg-overview-dark-blue/90 text-white font-bold py-3 px-6 rounded-full transition-colors duration-300">
                ãŠå•ã„åˆã›ã¯ã‚³ãƒãƒ©
              </a>
            </div>
          </div>
          
        </div>
      </div>
    </section>
  </main>
  
  <Footer />
</Layout>

<style>
  /* ä¸¸ã¿ã‚’å¸¯ã³ãŸè¦ªã—ã¿ã‚„ã™ã„ãƒ•ã‚©ãƒ³ãƒˆèª¿æ•´ */
  body {
    font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', sans-serif;
  }
  
  /* backGround.png ã‚’èƒŒæ™¯ã¨ã—ã¦ä½¿ç”¨ */
  body {
    background-image: url('/images/backGround.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
  }
  
  /* èƒŒæ™¯ç”»åƒã®ä¸Šã«è»½ã„ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’è¿½åŠ  */
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, rgba(135, 206, 235, 0.1) 0%, rgba(255, 215, 0, 0.1) 100%);
    pointer-events: none;
    z-index: -1;
  }
</style>